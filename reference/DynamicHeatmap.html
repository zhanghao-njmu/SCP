<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Heatmap plot for dynamic features along lineages"><title>Heatmap plot for dynamic features along lineages — DynamicHeatmap • SCP</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Heatmap plot for dynamic features along lineages — DynamicHeatmap"><meta property="og:description" content="Heatmap plot for dynamic features along lineages"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/zhanghao-njmu/SCP">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Heatmap plot for dynamic features along lineages</h1>
      <small class="dont-index">Source: <a href="https://github.com/zhanghao-njmu/SCP/blob/HEAD/R/SCP-plot.R" class="external-link"><code>R/SCP-plot.R</code></a></small>
      <div class="d-none name"><code>DynamicHeatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Heatmap plot for dynamic features along lineages</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DynamicHeatmap</span><span class="op">(</span></span>
<span>  <span class="va">srt</span>,</span>
<span>  <span class="va">lineages</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_fitted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  flip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  min_expcells <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  r.sq <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  dev.expl <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  padjust <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  num_intersections <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell_density <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cell_bins <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  order_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"peaktime"</span>, <span class="st">"valleytime"</span><span class="op">)</span>,</span>
<span>  slot <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exp_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"zscore"</span>, <span class="st">"raw"</span>, <span class="st">"fc"</span>, <span class="st">"log2fc"</span>, <span class="st">"log1p"</span><span class="op">)</span>,</span>
<span>  exp_legend_title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  limits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lib_normalize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">slot</span>, <span class="st">"counts"</span><span class="op">)</span>,</span>
<span>  libsize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster_features_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster_row_slices <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster_column_slices <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_row_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_column_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  row_names_side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">flip</span>, <span class="st">"left"</span>, <span class="st">"right"</span><span class="op">)</span>,</span>
<span>  column_names_side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">flip</span>, <span class="st">"bottom"</span>, <span class="st">"top"</span><span class="op">)</span>,</span>
<span>  row_names_rot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  column_names_rot <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  row_title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column_title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_title_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>  column_title_side <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>  row_title_rot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  column_title_rot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">flip</span>, <span class="fl">90</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  feature_split <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  feature_split_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_split <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split_order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mfuzz"</span>, <span class="st">"kmeans"</span>, <span class="st">"kmeans-peaktime"</span>, <span class="st">"hclust"</span>, <span class="st">"hclust-peaktime"</span><span class="op">)</span>,</span>
<span>  decreasing <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fuzzification <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  anno_terms <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  anno_keys <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  anno_features <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  terms_width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"in"</span><span class="op">)</span>,</span>
<span>  terms_fontsize <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  keys_width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"in"</span><span class="op">)</span>,</span>
<span>  keys_fontsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  features_width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"in"</span><span class="op">)</span>,</span>
<span>  features_fontsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  IDtype <span class="op">=</span> <span class="st">"symbol"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Homo_sapiens"</span>,</span>
<span>  db_update <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  db_version <span class="op">=</span> <span class="st">"latest"</span>,</span>
<span>  db_combine <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  convert_species <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  Ensembl_version <span class="op">=</span> <span class="fl">103</span>,</span>
<span>  mirror <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  db <span class="op">=</span> <span class="st">"GO_BP"</span>,</span>
<span>  TERM2GENE <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  TERM2NAME <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  minGSSize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  maxGSSize <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  GO_simplify <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  GO_simplify_cutoff <span class="op">=</span> <span class="st">"p.adjust &lt; 0.05"</span>,</span>
<span>  simplify_method <span class="op">=</span> <span class="st">"Wang"</span>,</span>
<span>  simplify_similarityCutoff <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  pvalueCutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  padjustCutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  topTerm <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  show_termid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  topWord <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  words_excluded <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nlabel <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  features_label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  label_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  pseudotime_label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pseudotime_label_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  pseudotime_label_linetype <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  pseudotime_label_linewidth <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  heatmap_palette <span class="op">=</span> <span class="st">"viridis"</span>,</span>
<span>  heatmap_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pseudotime_palette <span class="op">=</span> <span class="st">"cividis"</span>,</span>
<span>  pseudotime_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  feature_split_palette <span class="op">=</span> <span class="st">"simspec"</span>,</span>
<span>  feature_split_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell_annotation_palette <span class="op">=</span> <span class="st">"Paired"</span>,</span>
<span>  cell_annotation_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell_annotation_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  feature_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  feature_annotation_palette <span class="op">=</span> <span class="st">"Dark2"</span>,</span>
<span>  feature_annotation_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  feature_annotation_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  separate_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  separate_annotation_palette <span class="op">=</span> <span class="st">"Paired"</span>,</span>
<span>  separate_annotation_palcolor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  separate_annotation_params <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">flip</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="kw">else</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  reverse_ht <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_raster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  raster_device <span class="op">=</span> <span class="st">"png"</span>,</span>
<span>  raster_by_magick <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  height <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  width <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  units <span class="op">=</span> <span class="st">"inch"</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  ht_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>srt</dt>
<dd><p>A Seurat object.</p></dd>


<dt>lineages</dt>
<dd><p>A character vector specifying the lineages to plot.</p></dd>


<dt>features</dt>
<dd><p>A character vector specifying the features to plot. By default, this parameter is set to NULL, and the dynamic features will be determined by the parameters  <code>min_expcells</code>, <code>r.sq</code>, <code>dev.expl</code>, <code>padjust</code> and <code>num_intersections</code>.</p></dd>


<dt>use_fitted</dt>
<dd><p>A logical indicating whether to use fitted values. Default is FALSE.</p></dd>


<dt>border</dt>
<dd><p>A logical indicating whether to add a border to the heatmap. Default is TRUE.</p></dd>


<dt>flip</dt>
<dd><p>A logical indicating whether to flip the heatmap. Default is FALSE.</p></dd>


<dt>min_expcells</dt>
<dd><p>A numeric value specifying the minimum number of expected cells. Default is 20.</p></dd>


<dt>r.sq</dt>
<dd><p>A numeric value specifying the R-squared threshold. Default is 0.2.</p></dd>


<dt>dev.expl</dt>
<dd><p>A numeric value specifying the deviance explained threshold. Default is 0.2.</p></dd>


<dt>padjust</dt>
<dd><p>A numeric value specifying the p-value adjustment threshold. Default is 0.05.</p></dd>


<dt>num_intersections</dt>
<dd><p>This parameter is a numeric vector used to determine the number of intersections among lineages. It helps in selecting which dynamic features will be used. By default, when this parameter is set to NULL, all dynamic features that pass the specified threshold will be used for each lineage.</p></dd>


<dt>cell_density</dt>
<dd><p>A numeric value is used to define the cell density within each cell bin. By default, this parameter is set to 1, which means that all cells will be included within each cell bin.</p></dd>


<dt>cell_bins</dt>
<dd><p>A numeric value specifying the number of cell bins. Default is 100.</p></dd>


<dt>order_by</dt>
<dd><p>A character vector specifying the order of the heatmap. Default is "peaktime".</p></dd>


<dt>slot</dt>
<dd><p>A character vector specifying the slot in the Seurat object to use. Default is "counts".</p></dd>


<dt>assay</dt>
<dd><p>A character vector specifying the assay in the Seurat object to use. Default is NULL.</p></dd>


<dt>exp_method</dt>
<dd><p>A character vector specifying the method for calculating expression values. Default is "zscore" with options "zscore", "raw", "fc", "log2fc", "log1p".</p></dd>


<dt>exp_legend_title</dt>
<dd><p>A character vector specifying the title for the legend of expression value. Default is NULL.</p></dd>


<dt>limits</dt>
<dd><p>A two-length numeric vector specifying the limits for the color scale. Default is NULL.</p></dd>


<dt>lib_normalize</dt>
<dd><p>A logical value indicating whether to normalize the data by library size.</p></dd>


<dt>libsize</dt>
<dd><p>A numeric vector specifying the library size for each cell. Default is NULL.</p></dd>


<dt>family</dt>
<dd><p>A character specifying the model used to calculate the dynamic features if needed. By default, this parameter is set to NULL, and the appropriate family will be automatically determined.</p></dd>


<dt>cluster_features_by</dt>
<dd><p>A character vector specifying which lineage to use when clustering features. By default, this parameter is set to NULL, which means that all lineages will be used.</p></dd>


<dt>cluster_rows</dt>
<dd><p>A logical value indicating whether to cluster rows in the heatmap. Default is FALSE.</p></dd>


<dt>cluster_row_slices</dt>
<dd><p>A logical value indicating whether to cluster row slices in the heatmap. Default is FALSE.</p></dd>


<dt>cluster_columns</dt>
<dd><p>A logical value indicating whether to cluster columns in the heatmap. Default is FALSE.</p></dd>


<dt>cluster_column_slices</dt>
<dd><p>A logical value indicating whether to cluster column slices in the heatmap. Default is FALSE.</p></dd>


<dt>show_row_names</dt>
<dd><p>A logical value indicating whether to show row names in the heatmap. Default is FALSE.</p></dd>


<dt>show_column_names</dt>
<dd><p>A logical value indicating whether to show column names in the heatmap. Default is FALSE.</p></dd>


<dt>row_names_side</dt>
<dd><p>A character vector specifying the side to place row names.</p></dd>


<dt>column_names_side</dt>
<dd><p>A character vector specifying the side to place column names.</p></dd>


<dt>row_names_rot</dt>
<dd><p>A numeric value specifying the rotation angle for row names. Default is 0.</p></dd>


<dt>column_names_rot</dt>
<dd><p>A numeric value specifying the rotation angle for column names. Default is 90.</p></dd>


<dt>row_title</dt>
<dd><p>A character vector specifying the title for rows. Default is NULL.</p></dd>


<dt>column_title</dt>
<dd><p>A character vector specifying the title for columns. Default is NULL.</p></dd>


<dt>row_title_side</dt>
<dd><p>A character vector specifying the side to place row title. Default is "left".</p></dd>


<dt>column_title_side</dt>
<dd><p>A character vector specifying the side to place column title. Default is "top".</p></dd>


<dt>row_title_rot</dt>
<dd><p>A numeric value specifying the rotation angle for row title. Default is 0.</p></dd>


<dt>column_title_rot</dt>
<dd><p>A numeric value specifying the rotation angle for column title.</p></dd>


<dt>feature_split</dt>
<dd><p>A factor specifying how to split the features. Default is NULL.</p></dd>


<dt>feature_split_by</dt>
<dd><p>A character vector specifying which group.by to use when splitting features (into n_split feature clusters). Default is NULL.</p></dd>


<dt>n_split</dt>
<dd><p>An integer specifying the number of feature splits (feature clusters) to create. Default is NULL.</p></dd>


<dt>split_order</dt>
<dd><p>A numeric vector specifying the order of splits. Default is NULL.</p></dd>


<dt>split_method</dt>
<dd><p>A character vector specifying the method for splitting features. Default is "kmeans" with options "kmeans", "hclust", "mfuzz").</p></dd>


<dt>decreasing</dt>
<dd><p>A logical value indicating whether to sort feature splits in decreasing order. Default is FALSE.</p></dd>


<dt>fuzzification</dt>
<dd><p>A numeric value specifying the fuzzification coefficient. Default is NULL.</p></dd>


<dt>anno_terms</dt>
<dd><p>A logical value indicating whether to include term annotations. Default is FALSE.</p></dd>


<dt>anno_keys</dt>
<dd><p>A logical value indicating whether to include key annotations. Default is FALSE.</p></dd>


<dt>anno_features</dt>
<dd><p>A logical value indicating whether to include feature annotations. Default is FALSE.</p></dd>


<dt>terms_width</dt>
<dd><p>A unit specifying the width of term annotations. Default is unit(4, "in").</p></dd>


<dt>terms_fontsize</dt>
<dd><p>A numeric vector specifying the font size(s) for term annotations. Default is 8.</p></dd>


<dt>keys_width</dt>
<dd><p>A unit specifying the width of key annotations. Default is unit(2, "in").</p></dd>


<dt>keys_fontsize</dt>
<dd><p>A two-length numeric vector specifying the minimum and maximum font size(s) for key annotations. Default is c(6, 10).</p></dd>


<dt>features_width</dt>
<dd><p>A unit specifying the width of feature annotations. Default is unit(2, "in").</p></dd>


<dt>features_fontsize</dt>
<dd><p>A two-length numeric vector specifying the minimum and maximum font size(s) for feature annotations. Default is c(6, 10).</p></dd>


<dt>IDtype</dt>
<dd><p>A character vector specifying the type of IDs for features. Default is "symbol".</p></dd>


<dt>species</dt>
<dd><p>A character vector specifying the species for features. Default is "Homo_sapiens".</p></dd>


<dt>db_update</dt>
<dd><p>A logical value indicating whether to update the database. Default is FALSE.</p></dd>


<dt>db_version</dt>
<dd><p>A character vector specifying the version of the database. Default is "latest".</p></dd>


<dt>db_combine</dt>
<dd><p>A logical value indicating whether to use a combined database. Default is FALSE.</p></dd>


<dt>convert_species</dt>
<dd><p>A logical value indicating whether to use a species-converted database if annotation is missing for <code>species</code>. Default is FALSE.</p></dd>


<dt>Ensembl_version</dt>
<dd><p>An integer specifying the Ensembl version. Default is 103.</p></dd>


<dt>mirror</dt>
<dd><p>A character vector specifying the mirror for the Ensembl database. Default is NULL.</p></dd>


<dt>db</dt>
<dd><p>A character vector specifying the database to use. Default is "GO_BP".</p></dd>


<dt>TERM2GENE</dt>
<dd><p>A data.frame specifying the TERM2GENE mapping for the database. Default is NULL.</p></dd>


<dt>TERM2NAME</dt>
<dd><p>A data.frame specifying the TERM2NAME mapping for the database. Default is NULL.</p></dd>


<dt>minGSSize</dt>
<dd><p>An integer specifying the minimum gene set size for the database. Default is 10.</p></dd>


<dt>maxGSSize</dt>
<dd><p>An integer specifying the maximum gene set size for the database. Default is 500.</p></dd>


<dt>GO_simplify</dt>
<dd><p>A logical value indicating whether to simplify gene ontology terms. Default is FALSE.</p></dd>


<dt>GO_simplify_cutoff</dt>
<dd><p>A character vector specifying the cutoff for GO simplification. Default is "p.adjust &lt; 0.05".</p></dd>


<dt>simplify_method</dt>
<dd><p>A character vector specifying the method for GO simplification. Default is "Wang".</p></dd>


<dt>simplify_similarityCutoff</dt>
<dd><p>A numeric value specifying the similarity cutoff for GO simplification. Default is 0.7.</p></dd>


<dt>pvalueCutoff</dt>
<dd><p>A numeric vector specifying the p-value cutoff(s) for significance. Default is NULL.</p></dd>


<dt>padjustCutoff</dt>
<dd><p>A numeric value specifying the adjusted p-value cutoff for significance. Default is 0.05.</p></dd>


<dt>topTerm</dt>
<dd><p>An integer specifying the number of top terms to include. Default is 5.</p></dd>


<dt>show_termid</dt>
<dd><p>A logical value indicating whether to show term IDs. Default is FALSE.</p></dd>


<dt>topWord</dt>
<dd><p>An integer specifying the number of top words to include. Default is 20.</p></dd>


<dt>words_excluded</dt>
<dd><p>A character vector specifying the words to exclude. Default is NULL.</p></dd>


<dt>nlabel</dt>
<dd><p>An integer specifying the number of labels to include. Default is 0.</p></dd>


<dt>features_label</dt>
<dd><p>A character vector specifying the features to label. Default is NULL.</p></dd>


<dt>label_size</dt>
<dd><p>A numeric value specifying the size of labels. Default is 10.</p></dd>


<dt>label_color</dt>
<dd><p>A character vector specifying the color of labels. Default is "black".</p></dd>


<dt>pseudotime_label</dt>
<dd><p>A numeric vector specifying the pseudotime label. Default is NULL.</p></dd>


<dt>pseudotime_label_color</dt>
<dd><p>A character string specifying the pseudotime label color. Default is "black".</p></dd>


<dt>pseudotime_label_linetype</dt>
<dd><p>A numeric value specifying the pseudotime label line type. Default is 2.</p></dd>


<dt>pseudotime_label_linewidth</dt>
<dd><p>A numeric value specifying the pseudotime label line width. Default is 3.</p></dd>


<dt>heatmap_palette</dt>
<dd><p>A character vector specifying the palette to use for the heatmap. Default is "RdBu".</p></dd>


<dt>heatmap_palcolor</dt>
<dd><p>A character vector specifying the heatmap color to use. Default is NULL.</p></dd>


<dt>pseudotime_palette</dt>
<dd><p>A character vector specifying the color palette to use for pseudotime.</p></dd>


<dt>pseudotime_palcolor</dt>
<dd><p>A list specifying the colors to use for the pseudotime in the heatmap.</p></dd>


<dt>feature_split_palette</dt>
<dd><p>A character vector specifying the palette to use for feature splits. Default is "simspec".</p></dd>


<dt>feature_split_palcolor</dt>
<dd><p>A character vector specifying the feature split color to use. Default is NULL.</p></dd>


<dt>cell_annotation</dt>
<dd><p>A character vector specifying the cell annotation(s) to include. Default is NULL.</p></dd>


<dt>cell_annotation_palette</dt>
<dd><p>A character vector specifying the palette to use for cell annotations. The length of the vector should match the number of cell_annotation. Default is "Paired".</p></dd>


<dt>cell_annotation_palcolor</dt>
<dd><p>A list of character vector specifying the cell annotation color(s) to use. The length of the list should match the number of cell_annotation. Default is NULL.</p></dd>


<dt>cell_annotation_params</dt>
<dd><p>A list specifying additional parameters for cell annotations. Default is a list with width = grid::unit(1, "cm") if flip is TRUE, else a list with height = grid::unit(1, "cm").</p></dd>


<dt>feature_annotation</dt>
<dd><p>A character vector specifying the feature annotation(s) to include. Default is NULL.</p></dd>


<dt>feature_annotation_palette</dt>
<dd><p>A character vector specifying the palette to use for feature annotations. The length of the vector should match the number of feature_annotation. Default is "Dark2".</p></dd>


<dt>feature_annotation_palcolor</dt>
<dd><p>A list of character vector specifying the feature annotation color to use. The length of the list should match the number of feature_annotation. Default is NULL.</p></dd>


<dt>feature_annotation_params</dt>
<dd><p>A list specifying additional parameters for feature annotations. Default is an empty list.</p></dd>


<dt>separate_annotation</dt>
<dd><p>A character vector of names of annotations to be displayed in separate annotation blocks. Each name should match a column name in the metadata of the Seurat object.</p></dd>


<dt>separate_annotation_palette</dt>
<dd><p>A character vector specifying the color palette to use for separate annotations.</p></dd>


<dt>separate_annotation_palcolor</dt>
<dd><p>A list specifying the colors to use for each level of the separate annotations.</p></dd>


<dt>separate_annotation_params</dt>
<dd><p>A list of other parameters to be passed to the HeatmapAnnotation function when creating the separate annotation blocks.</p></dd>


<dt>reverse_ht</dt>
<dd><p>A logical indicating whether to reverse the heatmap. Default is NULL.</p></dd>


<dt>use_raster</dt>
<dd><p>A logical value indicating whether to use a raster device for plotting. Default is NULL.</p></dd>


<dt>raster_device</dt>
<dd><p>A character vector specifying the raster device to use. Default is "png".</p></dd>


<dt>raster_by_magick</dt>
<dd><p>A logical value indicating whether to use the 'magick' package for raster. Default is FALSE.</p></dd>


<dt>height</dt>
<dd><p>A numeric vector specifying the height(s) of the heatmap body. Default is NULL.</p></dd>


<dt>width</dt>
<dd><p>A numeric vector specifying the width(s) of the heatmap body. Default is NULL.</p></dd>


<dt>units</dt>
<dd><p>A character vector specifying the units for the height and width. Default is "inch".</p></dd>


<dt>seed</dt>
<dd><p>An integer specifying the random seed. Default is 11.</p></dd>


<dt>ht_params</dt>
<dd><p>A list specifying additional parameters passed to the ComplexHeatmap::Heatmap function. Default is an empty list.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="RunDynamicFeatures.html">RunDynamicFeatures</a></code> <code><a href="RunDynamicEnrichment.html">RunDynamicEnrichment</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pancreas_sub"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pancreas_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="RunSlingshot.html">RunSlingshot</a></span><span class="op">(</span><span class="va">pancreas_sub</span>, group.by <span class="op">=</span> <span class="st">"SubCellType"</span>, reduction <span class="op">=</span> <span class="st">"UMAP"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 8 rows containing missing values (`geom_path()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 8 rows containing missing values (`geom_path()`).</span>
<span class="r-plt img"><img src="DynamicHeatmap-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">pancreas_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="RunDynamicFeatures.html">RunDynamicFeatures</a></span><span class="op">(</span><span class="va">pancreas_sub</span>, lineages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lineage1"</span>, <span class="st">"Lineage2"</span><span class="op">)</span>, n_candidates <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [2023-10-30 09:42:02.425622] Start RunDynamicFeatures</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Workers: 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of candidate features(union): 225</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate dynamic features for Lineage1...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                                                                      |                                                                                                              |   0%  |                                                                                                                      |==============================================================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate dynamic features for Lineage2...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                                                                      |                                                                                                              |   0%  |                                                                                                                      |==============================================================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [2023-10-30 09:42:27.732241] RunDynamicFeatures done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Elapsed time:25.31 secs</span>
<span class="r-in"><span><span class="va">ht1</span> <span class="op">&lt;-</span> <span class="fu">DynamicHeatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  srt <span class="op">=</span> <span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  lineages <span class="op">=</span> <span class="st">"Lineage1"</span>,</span></span>
<span class="r-in"><span>  n_split <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  split_method <span class="op">=</span> <span class="st">"kmeans-peaktime"</span>,</span></span>
<span class="r-in"><span>  cell_annotation <span class="op">=</span> <span class="st">"SubCellType"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 151 features from Lineage1 passed the threshold (exp_ncells&gt;20 &amp; r.sq&gt;0.2 &amp; dev.expl&gt;0.2 &amp; padjust&lt;0.05): </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Gcg,Iapp,Pyy,Chgb,Slc38a5,Rbp4,Lrpprc,Cck,2810417H13Rik,Chga...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'magick' package is suggested to install to give better rasterization.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Set `ht_opt$message = FALSE` to turn off this message.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The size of the heatmap is fixed because certain elements are not scalable.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               The width and height of the heatmap are determined by the size of the current viewport.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               If you want to have more control over the size, you can manually set the parameters 'width' and 'height'.</span>
<span class="r-in"><span><span class="va">ht1</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="DynamicHeatmap-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="panel_fix.html">panel_fix</a></span><span class="op">(</span><span class="va">ht1</span><span class="op">$</span><span class="va">plot</span>, raster <span class="op">=</span> <span class="cn">TRUE</span>, dpi <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DynamicHeatmap-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ht2</span> <span class="op">&lt;-</span> <span class="fu">DynamicHeatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  srt <span class="op">=</span> <span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  lineages <span class="op">=</span> <span class="st">"Lineage1"</span>,</span></span>
<span class="r-in"><span>  features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sox9"</span>, <span class="st">"Neurod2"</span>, <span class="st">"Isl1"</span>, <span class="st">"Rbp4"</span>, <span class="st">"Pyy"</span>, <span class="st">"S_score"</span>, <span class="st">"G2M_score"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  cell_annotation <span class="op">=</span> <span class="st">"SubCellType"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [2023-10-30 09:42:33.878917] Start RunDynamicFeatures</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Workers: 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of candidate features(union): 2</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative values detected!</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Negative values detected!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculate dynamic features for Lineage1...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                                                                      |                                                                                                              |   0%  |                                                                                                                      |==============================================================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [2023-10-30 09:42:35.502732] RunDynamicFeatures done</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Elapsed time:1.62 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Some features were missing in at least one lineage: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Isl1,Neurod2,Pyy,Rbp4,Sox9...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'magick' package is suggested to install to give better rasterization.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Set `ht_opt$message = FALSE` to turn off this message.</span>
<span class="r-in"><span><span class="va">ht2</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="DynamicHeatmap-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="panel_fix.html">panel_fix</a></span><span class="op">(</span><span class="va">ht2</span><span class="op">$</span><span class="va">plot</span>, height <span class="op">=</span> <span class="fl">5</span>, width <span class="op">=</span> <span class="fl">5</span>, raster <span class="op">=</span> <span class="cn">TRUE</span>, dpi <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DynamicHeatmap-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ht3</span> <span class="op">&lt;-</span> <span class="fu">DynamicHeatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  srt <span class="op">=</span> <span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  lineages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lineage1"</span>, <span class="st">"Lineage2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_split <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  split_method <span class="op">=</span> <span class="st">"kmeans"</span>,</span></span>
<span class="r-in"><span>  cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  cell_annotation <span class="op">=</span> <span class="st">"SubCellType"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 169 features from Lineage1,Lineage2 passed the threshold (exp_ncells&gt;20 &amp; r.sq&gt;0.2 &amp; dev.expl&gt;0.2 &amp; padjust&lt;0.05): </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Gcg,Iapp,Pyy,Chgb,Slc38a5,Rbp4,Lrpprc,Cck,2810417H13Rik,Chga...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'magick' package is suggested to install to give better rasterization.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Set `ht_opt$message = FALSE` to turn off this message.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The size of the heatmap is fixed because certain elements are not scalable.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               The width and height of the heatmap are determined by the size of the current viewport.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               If you want to have more control over the size, you can manually set the parameters 'width' and 'height'.</span>
<span class="r-in"><span><span class="va">ht3</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="DynamicHeatmap-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pancreas_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="AnnotateFeatures.html">AnnotateFeatures</a></span><span class="op">(</span><span class="va">pancreas_sub</span>, species <span class="op">=</span> <span class="st">"Mus_musculus"</span>, db <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TF"</span>, <span class="st">"CSPA"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Species: Mus_musculus</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading cached db: TF version:AnimalTFDB4 nterm:2 created:2023-10-30 09:34:04.589855</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading cached db: CSPA version:CSPA nterm:1 created:2023-10-30 09:34:08.354181</span>
<span class="r-in"><span><span class="va">ht4</span> <span class="op">&lt;-</span> <span class="fu">DynamicHeatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  srt <span class="op">=</span> <span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  lineages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lineage1"</span>, <span class="st">"Lineage2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  reverse_ht <span class="op">=</span> <span class="st">"Lineage1"</span>,</span></span>
<span class="r-in"><span>  use_fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  n_split <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  split_method <span class="op">=</span> <span class="st">"mfuzz"</span>,</span></span>
<span class="r-in"><span>  heatmap_palette <span class="op">=</span> <span class="st">"viridis"</span>,</span></span>
<span class="r-in"><span>  cell_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SubCellType"</span>, <span class="st">"Phase"</span>, <span class="st">"G2M_score"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  cell_annotation_palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Paired"</span>, <span class="st">"simspec"</span>, <span class="st">"Purples"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  separate_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"SubCellType"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nnat"</span>, <span class="st">"Irx1"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  separate_annotation_palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Paired"</span>, <span class="st">"Set1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  separate_annotation_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  feature_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TF"</span>, <span class="st">"CSPA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  feature_annotation_palcolor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gold"</span>, <span class="st">"steelblue"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forestgreen"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pseudotime_label <span class="op">=</span> <span class="fl">25</span>,</span></span>
<span class="r-in"><span>  pseudotime_label_color <span class="op">=</span> <span class="st">"red"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 169 features from Lineage1,Lineage2 passed the threshold (exp_ncells&gt;20 &amp; r.sq&gt;0.2 &amp; dev.expl&gt;0.2 &amp; padjust&lt;0.05): </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Gcg,Iapp,Pyy,Chgb,Slc38a5,Rbp4,Lrpprc,Cck,2810417H13Rik,Chga...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'magick' package is suggested to install to give better rasterization.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Set `ht_opt$message = FALSE` to turn off this message.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The size of the heatmap is fixed because certain elements are not scalable.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               The width and height of the heatmap are determined by the size of the current viewport.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               If you want to have more control over the size, you can manually set the parameters 'width' and 'height'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Picking joint bandwidth of 20.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Picking joint bandwidth of 18.6</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Picking joint bandwidth of 20.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Picking joint bandwidth of 18.6</span>
<span class="r-in"><span><span class="va">ht4</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="DynamicHeatmap-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ht5</span> <span class="op">&lt;-</span> <span class="fu">DynamicHeatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  srt <span class="op">=</span> <span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  lineages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lineage1"</span>, <span class="st">"Lineage2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  reverse_ht <span class="op">=</span> <span class="st">"Lineage1"</span>,</span></span>
<span class="r-in"><span>  use_fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  n_split <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  split_method <span class="op">=</span> <span class="st">"mfuzz"</span>,</span></span>
<span class="r-in"><span>  heatmap_palette <span class="op">=</span> <span class="st">"viridis"</span>,</span></span>
<span class="r-in"><span>  cell_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SubCellType"</span>, <span class="st">"Phase"</span>, <span class="st">"G2M_score"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  cell_annotation_palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Paired"</span>, <span class="st">"simspec"</span>, <span class="st">"Purples"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  separate_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"SubCellType"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nnat"</span>, <span class="st">"Irx1"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  separate_annotation_palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Paired"</span>, <span class="st">"Set1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  separate_annotation_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  feature_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TF"</span>, <span class="st">"CSPA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  feature_annotation_palcolor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gold"</span>, <span class="st">"steelblue"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forestgreen"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pseudotime_label <span class="op">=</span> <span class="fl">25</span>,</span></span>
<span class="r-in"><span>  pseudotime_label_color <span class="op">=</span> <span class="st">"red"</span>,</span></span>
<span class="r-in"><span>  flip <span class="op">=</span> <span class="cn">TRUE</span>, column_title_rot <span class="op">=</span> <span class="fl">45</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 169 features from Lineage1,Lineage2 passed the threshold (exp_ncells&gt;20 &amp; r.sq&gt;0.2 &amp; dev.expl&gt;0.2 &amp; padjust&lt;0.05): </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Gcg,Iapp,Pyy,Chgb,Slc38a5,Rbp4,Lrpprc,Cck,2810417H13Rik,Chga...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'magick' package is suggested to install to give better rasterization.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Set `ht_opt$message = FALSE` to turn off this message.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The size of the heatmap is fixed because certain elements are not scalable.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               The width and height of the heatmap are determined by the size of the current viewport.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>               If you want to have more control over the size, you can manually set the parameters 'width' and 'height'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Picking joint bandwidth of 20.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Picking joint bandwidth of 18.6</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Picking joint bandwidth of 20.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Picking joint bandwidth of 18.6</span>
<span class="r-in"><span><span class="va">ht5</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-plt img"><img src="DynamicHeatmap-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ht6</span> <span class="op">&lt;-</span> <span class="fu">DynamicHeatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  srt <span class="op">=</span> <span class="va">pancreas_sub</span>,</span></span>
<span class="r-in"><span>  lineages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lineage1"</span>, <span class="st">"Lineage2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  reverse_ht <span class="op">=</span> <span class="st">"Lineage1"</span>,</span></span>
<span class="r-in"><span>  cell_annotation <span class="op">=</span> <span class="st">"SubCellType"</span>,</span></span>
<span class="r-in"><span>  n_split <span class="op">=</span> <span class="fl">5</span>, split_method <span class="op">=</span> <span class="st">"mfuzz"</span>,</span></span>
<span class="r-in"><span>  species <span class="op">=</span> <span class="st">"Mus_musculus"</span>, db <span class="op">=</span> <span class="st">"GO_BP"</span>,</span></span>
<span class="r-in"><span>  anno_terms <span class="op">=</span> <span class="cn">TRUE</span>, anno_keys <span class="op">=</span> <span class="cn">TRUE</span>, anno_features <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 169 features from Lineage1,Lineage2 passed the threshold (exp_ncells&gt;20 &amp; r.sq&gt;0.2 &amp; dev.expl&gt;0.2 &amp; padjust&lt;0.05): </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Gcg,Iapp,Pyy,Chgb,Slc38a5,Rbp4,Lrpprc,Cck,2810417H13Rik,Chga...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'magick' package is suggested to install to give better rasterization.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Set `ht_opt$message = FALSE` to turn off this message.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [2023-10-30 09:43:01.832747] Start Enrichment</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Workers: 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Species: Mus_musculus</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Preparing database: GO_BP</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Convert ID types for the database: GO_BP</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Connect to the Ensembl archives...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using the 103 version of biomart...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Connecting to the biomart...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Searching the dataset mmusculus ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Connecting to the dataset mmusculus_gene_ensembl ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converting the geneIDs...</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in collect(., Inf):</span> Failed to collect lazy table.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Caused by error in `db_collect()`:</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Arguments in `...` must be used.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">✖</span> Problematic argument:</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> ..1 = Inf</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Did you misspell an argument name?</span>
<span class="r-in"><span><span class="va">ht6</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'ht6' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Hao Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

